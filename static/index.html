<!DOCTYPE html>
<html>
<head>
    <title>treelan on the Web</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script type="text/javascript" src="lib/require.js"></script> 
    <link rel="stylesheet" type="text/css" href="css/json-formatter.css">
</head>
<body>
<div class="root"></div>
<div id="inputs">
<textarea id="code" rows="25" cols="100">
String p="str"+((8+9)-7*5)/6;
Tree xmlTree;
int sum=15+16+17*3;
</textarea>
<br/>
<button id="parse">Parse</button>
</div>
<script type="text/javascript">

var antlr4 = require('antlr4/index');
var treelanLexer = require('generated-parser/treelanLexer');
var treelanParser = require('generated-parser/treelanParser');
var JSONFormatter=require('lib/json/json-formatter');

document.getElementById("parse").addEventListener("click", function(){
    var input = document.getElementById("code").value;
    var chars = new antlr4.InputStream(input);
    var lexer = new treelanLexer.treelanLexer(chars);
    var tokens  = new antlr4.CommonTokenStream(lexer);
    var parser = new treelanParser.treelanParser(tokens);
    parser.buildParseTrees = true;
    var tree = parser.stats();
    console.log("Parsed: "+ tree);
    //get target html element
    var target = '.root';

    const formatter = new JSONFormatter(tree);
    document.getElementsByClassName("root")[0].innerHTML = '';
    document.getElementsByClassName("root")[0].appendChild(formatter.render());
    
});
</script>
<div id="tree">
</div> 
</body>
</html>